extends layout.pug

block content
  .container
    br
    p.clementine-text Validation for: #{validation.name}
    p #{validation.tag}
    p.subtle#validation-id #{validation._id}
    br

    .container
      p
    .container.bugList
      if bugs
         each bug in bugs
            div(class="bug row" id=bug._id)
                .col-md-3.upvotes
                    p Repros (#{bug.upvotes.length}):
                    if bug.upvotes
                        each upvote in bug.upvotes
                            p.vote #{upvote}
                .col-md-6
                   p.bug-text  #[strong #{bug.name}] (#{bug.vstsState})
                   p.timestamp #{bug.timestamp.toLocaleString()}
                   br
                   .btn-container
                      button.btn.btn-upvote.btn-success(type="submit") I can repro
                      button.btn.btn-downvote.btn-danger(type="submit") Cannot repro
                   p.subtle #{bug._id}
                   p.subtle.deep-link
                    i.fa.fa-link   Link
                .col-md-3.downvotes
                    p No-repros (#{bug.downvotes.length}):
                    if bug.downvotes
                        each downvote in bug.downvotes
                            p.vote #{downvote}
      .container.caseList
          if cases.length > 0
             each kase in cases
                .panel.panel-default.case.row(id=kase._id)
                    .col-md-3.upvotes
                        p Works (#{kase.upvotes_v2.length}):
                        if kase.upvotes_v2
                            each upvote in kase.upvotes_v2
                                p.vote #{upvote.email}
                    .col-md-6
                       h4.case-text  #{kase.name}
                       if kase.description
                          .well
                             p.case-description !{kase.description}
                       br
                       .btn-container
                          button.btn.btn-upvote.btn-success(type="submit") Works
                          button.btn.btn-downvote.btn-danger(type="submit", data-toggle="modal", data-target="#report-modal") Fails
                       p.timestamp #{kase.timestamp.toLocaleString()}
                       p.subtle #{kase._id}
                       p.subtle.deep-link
                        i.fa.fa-link   Link
                    .col-md-3.downvotes
                        p Fails (#{kase.downvotes_v2.length}):
                        if kase.downvotes_v2
                            each downvote in kase.downvotes_v2
                                p.vote #{downvote.email}
          else
            p No scenarios have been added yet. Check back later!

    #report-modal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='modalLabel', aria-hidden='true')
      .modal-dialog(role='document')
        .modal-content
          .modal-header
            h5#modalLabel.modal-title Please Report a Problem
            button.close(type='button', data-dismiss='modal', aria-label='Close')
              span(aria-hidden='true')
                i.fa.fa-times
          .modal-body
            | Your vote has been recorded. Please submit more details through "Report a Problem" as well.
          .modal-footer
            button.btn.btn-primary(type='button', data-dismiss="modal") OK

    script(type="text/javascript", src="/controllers/bugController.client.js")
    script(type="text/javascript", src="/controllers/caseController.client.js")